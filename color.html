<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Color Converter</title>
    <style>
      * {
        box-sizing: border-box;
      }
      :root {
        --bg: #0e0f11;
        --panel: #16181c;
        --ink: #e9ecf1;
        --muted: #9aa5b1;
        --accent: #4cc9f0;
        --ok: #22c55e;
        --warn: #f59e0b;
        --radius: 14px;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue",
          Helvetica, Arial, "Segoe UI", Roboto, "Noto Sans", "Apple Color Emoji",
          "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
        background: linear-gradient(180deg, #0b0c0e, var(--bg));
        color: var(--ink);
        display: grid;
        place-items: center;
        padding: 24px;
      }
      .container {
        width: 100%;
        max-width: 900px;
        background: var(--panel);
        border: 1px solid #23262d;
        border-radius: var(--radius);
        padding: 18px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
      }
      h1 {
        margin: 0 0 6px;
        font-size: 22px;
        font-weight: 700;
      }
      p.sub {
        margin: 0 0 14px;
        color: var(--muted);
        font-size: 14px;
      }
      .grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 12px;
      }
      @media (min-width: 820px) {
        .grid {
          grid-template-columns: 1.2fr 1fr;
        }
      }
      .card {
        background: #111317;
        border: 1px solid #22252c;
        border-radius: 12px;
        padding: 14px;
      }
      label {
        display: block;
        font-size: 13px;
        color: var(--muted);
        margin-bottom: 6px;
      }
      input,
      select,
      textarea,
      button {
        width: 100%;
        font-size: 16px;
        font-family: Helvetica, Arial, sans-serif;
      }
      input[type="text"],
      input[type="number"],
      input[type="color"],
      select {
        background: #0f1115;
        color: var(--ink);
        border: 1px solid #2a2e36;
        border-radius: 10px;
        padding: 10px 12px;
        outline: none;
      }
      input[type="text"]:focus,
      input[type="number"]:focus,
      input[type="color"]:focus,
      select:focus {
        border-color: var(--accent);
      }
      .row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
      }
      .row-3 {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
      }
      button {
        background: linear-gradient(180deg, #1c2027, #15181d);
        color: var(--ink);
        border: 1px solid #262a32;
        border-radius: 10px;
        padding: 10px 12px;
        cursor: pointer;
      }
      button:hover {
        border-color: var(--accent);
      }
      .badge {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid #2b3038;
        color: var(--muted);
      }
      .inline {
        display: inline-flex;
        gap: 8px;
        align-items: center;
      }
      .kv {
        display: grid;
        gap: 6px;
      }
      .kv-row {
        display: grid;
        grid-template-columns: 110px 1fr auto;
        gap: 8px 10px;
        align-items: center;
        padding: 4px 6px;
        border-radius: 8px;
        cursor: pointer;
      }
      .kv-row:hover {
        background: #0f1115;
      }
      .dim {
        color: var(--muted);
      }
      .helper {
        font-size: 12px;
        color: var(--muted);
        margin-top: 6px;
      }
      hr {
        border: none;
        border-top: 1px solid #242831;
        margin: 12px 0;
      }
      .preview {
        border: 1px solid #2a2e36;
        border-radius: 10px;
        overflow: hidden;
      }
      .checker {
        width: 100%;
        height: 160px;
        background: conic-gradient(
              #0000 0.25turn,
              #2a2e36 0 0.5turn,
              #0000 0 0.75turn,
              #2a2e36 0
            )
            0 0/16px 16px,
          #0f1115;
        position: relative;
      }
      .fill {
        position: absolute;
        inset: 0;
      }
      .mono {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
      }
      .code {
        font-variant-numeric: tabular-nums;
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
        letter-spacing: 0.02em;
      }
      .copyBtn {
        width: auto;
        padding: 6px 10px;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.12s ease;
      }
      .kv-row:hover .copyBtn {
        opacity: 1;
        pointer-events: auto;
      }
      .ok {
        color: var(--ok);
      }
      .warn {
        color: var(--warn);
      }
      /* Advanced drag picker */
      .picker2 {
        margin-top: 12px;
        display: grid;
        gap: 10px;
      }
      .slPanel {
        position: relative;
        height: 180px;
        border-radius: 10px;
        border: 1px solid #2a2e36;
        overflow: hidden;
        touch-action: none;
      }
      .slPanel .overlay1 {
        position: absolute;
        inset: 0;
        background: linear-gradient(90deg, #fff, transparent);
      }
      .slPanel .overlay2 {
        position: absolute;
        inset: 0;
        background: linear-gradient(0deg, #000, transparent);
        mix-blend-mode: multiply;
      }
      .slHandle {
        position: absolute;
        width: 14px;
        height: 14px;
        border-radius: 50%;
        border: 2px solid #fff;
        box-shadow: 0 0 0 1px #0006;
        transform: translate(-50%, -50%);
        left: 50%;
        top: 50%;
        z-index: 2;
      }
      .hueBar {
        position: relative;
        height: 14px;
        border-radius: 999px;
        border: 1px solid #2a2e36;
        overflow: hidden;
        touch-action: none;
      }
      .hueHandle {
        position: absolute;
        top: 50%;
        left: 0;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        border: 2px solid #fff;
        box-shadow: 0 0 0 1px #0006;
        transform: translate(-50%, -50%);
        background: transparent;
        z-index: 2;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Color Converter</h1>
      <p class="sub">
        Paste any CSS color. Detect, preview, convert, and copy across formats.
      </p>

      <div class="grid">
        <div class="card">
          <label for="input">Color Input</label>
          <input
            id="input"
            type="text"
            placeholder="#4cc9f0, rgb(12,34,56), hsl(210 50% 40% / 0.8), red"
          />
          <div class="row" style="margin-top: 10px">
            <div class="inline" style="justify-content: flex-start; gap: 10px">
              <span class="badge">Detected</span>
              <span id="detected" class="mono dim">—</span>
            </div>
            <div class="inline" style="justify-content: flex-end; gap: 10px">
              <label for="displayType" class="dim" style="margin: 0"
                >Display as</label
              >
              <select id="displayType" style="width: auto">
                <option value="hex">HEX</option>
                <option value="rgb">RGB</option>
                <option value="rgba">RGBA</option>
                <option value="hsl">HSL</option>
                <option value="hsla" selected>HSLA</option>
              </select>
            </div>
          </div>

          <hr />

          <div class="helper">
            Tip: Use the picker below or paste a color string above.
          </div>

          <div class="picker2">
            <div id="sl" class="slPanel">
              <div class="overlay1"></div>
              <div class="overlay2"></div>
              <div id="slHandle" class="slHandle"></div>
            </div>
            <div id="hue" class="hueBar">
              <div id="hueHandle" class="hueHandle"></div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="preview">
            <div class="checker">
              <div id="fill" class="fill"></div>
            </div>
          </div>

          <hr />

          <div class="kv">
            <div class="kv-row" data-format="hex">
              <div class="dim">HEX</div>
              <div id="outHex" class="code mono">—</div>
              <button class="copyBtn" data-copy="hex">Copy</button>
            </div>
            <div class="kv-row" data-format="rgb">
              <div class="dim">RGB</div>
              <div id="outRgb" class="code mono">—</div>
              <button class="copyBtn" data-copy="rgb">Copy</button>
            </div>
            <div class="kv-row" data-format="rgba">
              <div class="dim">RGBA</div>
              <div id="outRgba" class="code mono">—</div>
              <button class="copyBtn" data-copy="rgba">Copy</button>
            </div>
            <div class="kv-row" data-format="hsl">
              <div class="dim">HSL</div>
              <div id="outHsl" class="code mono">—</div>
              <button class="copyBtn" data-copy="hsl">Copy</button>
            </div>
            <div class="kv-row" data-format="hsla">
              <div class="dim">HSLA</div>
              <div id="outHsla" class="code mono">—</div>
              <button class="copyBtn" data-copy="hsla">Copy</button>
            </div>
            <div class="kv-row" data-format="csshsl">
              <div class="dim">CSS HSL</div>
              <div id="outCssHsl" class="code mono">—</div>
              <button class="copyBtn" data-copy="csshsl">Copy</button>
            </div>
            <div class="kv-row" data-format="csshsla">
              <div class="dim">CSS HSLA</div>
              <div id="outCssHsla" class="code mono">—</div>
              <button class="copyBtn" data-copy="csshsla">Copy</button>
            </div>
          </div>

          <div id="status" class="helper" style="margin-top: 10px"></div>
        </div>
      </div>
    </div>

    <script type="module">
      // code in here should not be indented at the first level

      const el = (id) => document.getElementById(id);
      const inputEl = el("input");
      const detectedEl = el("detected");
      const displayTypeEl = el("displayType");
      // removed simple picker and numeric HSL inputs
      const pickerEl = null;
      const alphaEl = null;
      const hEl = null;
      const sEl = null;
      const lEl = null;
      const fillEl = el("fill");
      const statusEl = el("status");

      const outHex = el("outHex");
      const outRgb = el("outRgb");
      const outRgba = el("outRgba");
      const outHsl = el("outHsl");
      const outHsla = el("outHsla");
      const outCssHsl = el("outCssHsl");
      const outCssHsla = el("outCssHsla");

      const copyButtons = Array.from(document.querySelectorAll(".copyBtn"));
      const copyRows = Array.from(document.querySelectorAll(".kv-row"));
      const slPanel = document.getElementById("sl");
      const slHandle = document.getElementById("slHandle");
      const hueBar = document.getElementById("hue");
      const hueHandle = document.getElementById("hueHandle");

      function clamp(v, min, max) {
        return Math.min(max, Math.max(min, v));
      }
      function round(v, d = 2) {
        const p = 10 ** d;
        return Math.round(v * p) / p;
      }

      function parseHex(str) {
        const s = str.trim().replace(/^#/, "");
        if (/^[0-9a-fA-F]{3}$/.test(s)) {
          const r = parseInt(s[0] + s[0], 16);
          const g = parseInt(s[1] + s[1], 16);
          const b = parseInt(s[2] + s[2], 16);
          return { r, g, b, a: 1, type: "hex" };
        }
        if (/^[0-9a-fA-F]{4}$/.test(s)) {
          const r = parseInt(s[0] + s[0], 16);
          const g = parseInt(s[1] + s[1], 16);
          const b = parseInt(s[2] + s[2], 16);
          const a = parseInt(s[3] + s[3], 16) / 255;
          return { r, g, b, a, type: "hex" };
        }
        if (/^[0-9a-fA-F]{6}$/.test(s)) {
          const r = parseInt(s.slice(0, 2), 16);
          const g = parseInt(s.slice(2, 4), 16);
          const b = parseInt(s.slice(4, 6), 16);
          return { r, g, b, a: 1, type: "hex" };
        }
        if (/^[0-9a-fA-F]{8}$/.test(s)) {
          const r = parseInt(s.slice(0, 2), 16);
          const g = parseInt(s.slice(2, 4), 16);
          const b = parseInt(s.slice(4, 6), 16);
          const a = parseInt(s.slice(6, 8), 16) / 255;
          return { r, g, b, a, type: "hex" };
        }
        return null;
      }

      function parseRgbFunc(str) {
        const s = str.trim().toLowerCase();
        const rx = /^rgba?\((.*)\)$/;
        const m = s.match(rx);
        if (!m) return null;
        // Support both comma and modern space-separated with optional '/ alpha'
        let inner = m[1].trim();
        if (inner.includes("/")) inner = inner.replace(/\s*\/\s*/, ",");
        // If there are commas, split by commas; otherwise split by whitespace
        let parts = inner.includes(",")
          ? inner.split(/\s*,\s*/)
          : inner.trim().split(/\s+/);
        if (parts.length < 3) return null;
        const parseComp = (p) =>
          p.endsWith("%")
            ? clamp(Math.round(parseFloat(p) * 2.55), 0, 255)
            : clamp(parseInt(p, 10), 0, 255);
        const r = parseComp(parts[0]);
        const g = parseComp(parts[1]);
        const b = parseComp(parts[2]);
        let a = 1;
        if (parts.length >= 4) a = clamp(parseFloat(parts[3]), 0, 1);
        return { r, g, b, a, type: parts.length >= 4 ? "rgba" : "rgb" };
      }

      function parseHslFunc(str) {
        const s = str.trim().toLowerCase();
        const rx = /^hsla?\((.*)\)$/;
        const m = s.match(rx);
        if (!m) return null;
        // Support both comma and space separated forms
        let inner = m[1].replace(/\s*\/\s*/g, ",");
        let parts = inner.split(/\s*,\s*/);
        if (parts.length < 3) return null;
        let h = parseFloat(parts[0]);
        let sPct = parts[1].trim().endsWith("%")
          ? parseFloat(parts[1])
          : parseFloat(parts[1]) * 100;
        let lPct = parts[2].trim().endsWith("%")
          ? parseFloat(parts[2])
          : parseFloat(parts[2]) * 100;
        let a = 1;
        if (parts.length >= 4) a = clamp(parseFloat(parts[3]), 0, 1);
        h = ((h % 360) + 360) % 360;
        sPct = clamp(sPct, 0, 100);
        lPct = clamp(lPct, 0, 100);
        const { r, g, b } = hslToRgb({ h, s: sPct / 100, l: lPct / 100 });
        return { r, g, b, a, type: parts.length >= 4 ? "hsla" : "hsl" };
      }

      function parseCssComputed(str) {
        const tmp = document.createElement("div");
        tmp.style.color = "#000";
        tmp.style.color = str;
        document.body.appendChild(tmp);
        const gs = getComputedStyle(tmp).color; // rgb(a)
        document.body.removeChild(tmp);
        const parsed = parseRgbFunc(gs);
        return parsed ? { ...parsed, type: "css" } : null;
      }

      function detectAndParse(str) {
        if (!str || !str.trim()) return null;
        return (
          parseHex(str) ||
          parseRgbFunc(str) ||
          parseHslFunc(str) ||
          parseCssComputed(str)
        );
      }

      function rgbToHsl({ r, g, b }) {
        const rs = r / 255,
          gs = g / 255,
          bs = b / 255;
        const max = Math.max(rs, gs, bs),
          min = Math.min(rs, gs, bs);
        let h,
          s,
          l = (max + min) / 2;
        if (max === min) {
          h = s = 0;
        } else {
          const d = max - min;
          s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
          switch (max) {
            case rs:
              h = (gs - bs) / d + (gs < bs ? 6 : 0);
              break;
            case gs:
              h = (bs - rs) / d + 2;
              break;
            default:
              h = (rs - gs) / d + 4;
              break;
          }
          h /= 6;
        }
        return { h: (h * 360 + 360) % 360, s, l };
      }

      function hslToRgb({ h, s, l }) {
        const c = (1 - Math.abs(2 * l - 1)) * s;
        const hp = h / 60;
        const x = c * (1 - Math.abs((hp % 2) - 1));
        let r1 = 0,
          g1 = 0,
          b1 = 0;
        if (0 <= hp && hp < 1) {
          r1 = c;
          g1 = x;
        } else if (1 <= hp && hp < 2) {
          r1 = x;
          g1 = c;
        } else if (2 <= hp && hp < 3) {
          g1 = c;
          b1 = x;
        } else if (3 <= hp && hp < 4) {
          g1 = x;
          b1 = c;
        } else if (4 <= hp && hp < 5) {
          r1 = x;
          b1 = c;
        } else if (5 <= hp && hp < 6) {
          r1 = c;
          b1 = x;
        }
        const m = l - c / 2;
        const r = Math.round((r1 + m) * 255);
        const g = Math.round((g1 + m) * 255);
        const b = Math.round((b1 + m) * 255);
        return { r, g, b };
      }

      function toHex({ r, g, b }) {
        const hx = (n) => n.toString(16).padStart(2, "0");
        return `#${hx(r)}${hx(g)}${hx(b)}`.toLowerCase();
      }
      function toRgb({ r, g, b }) {
        return `rgb(${r}, ${g}, ${b})`;
      }
      function toRgba({ r, g, b, a }) {
        return `rgba(${r}, ${g}, ${b}, ${round(a, 3)})`;
      }
      function toHsl({ r, g, b }) {
        const { h, s, l } = rgbToHsl({ r, g, b });
        return `hsl(${Math.round(h)}, ${Math.round(s * 100)}%, ${Math.round(
          l * 100
        )}%)`;
      }
      function toHsla({ r, g, b, a }) {
        const { h, s, l } = rgbToHsl({ r, g, b });
        return `hsla(${Math.round(h)}, ${Math.round(s * 100)}%, ${Math.round(
          l * 100
        )}%, ${round(a, 3)})`;
      }
      function toCssHslSpaces({ r, g, b }) {
        const { h, s, l } = rgbToHsl({ r, g, b });
        return `${Math.round(h)} ${Math.round(s * 100)}% ${Math.round(
          l * 100
        )}%`;
      }
      function toCssHslaSpaces({ r, g, b, a }) {
        const { h, s, l } = rgbToHsl({ r, g, b });
        return `${Math.round(h)} ${Math.round(s * 100)}% ${Math.round(
          l * 100
        )}% / ${round(a, 3)}`;
      }

      function setStatus(msg, ok = true) {
        statusEl.textContent = msg || "";
        statusEl.className = "helper " + (ok ? "ok" : "warn");
      }

      let current = { r: 76, g: 201, b: 240, a: 1 };
      let suppressInputUpdate = false;

      function updateAll(fromInput = false, detectedTypeHint = null) {
        // Update picker and alpha
        // no simple picker/alpha inputs

        // Update HSL fields
        // numeric HSL fields removed

        // Update preview
        fillEl.style.background = toRgba(current);

        // Outputs
        outHex.textContent = toHex(current);
        outRgb.textContent = toRgb(current);
        outRgba.textContent = toRgba(current);
        outHsl.textContent = toHsl(current);
        outHsla.textContent = toHsla(current);
        outCssHsl.textContent = toCssHslSpaces(current);
        outCssHsla.textContent = toCssHslaSpaces(current);

        // Sync advanced picker UI
        setSLBackground();
        positionHandles();

        // Detected type display
        if (detectedTypeHint)
          detectedEl.textContent = detectedTypeHint.toUpperCase();

        // Main input display formatting
        if (!fromInput) {
          const t = displayTypeEl.value;
          suppressInputUpdate = true;
          switch (t) {
            case "hex":
              inputEl.value = toHex(current);
              break;
            case "rgb":
              inputEl.value = toRgb(current);
              break;
            case "rgba":
              inputEl.value = toRgba(current);
              break;
            case "hsl":
              inputEl.value = toHsl(current);
              break;
            case "hsla":
              inputEl.value = toHsla(current);
              break;
          }
          suppressInputUpdate = false;
        }
      }

      function handleInputChange() {
        if (suppressInputUpdate) return;
        const v = inputEl.value.trim();
        const parsed = detectAndParse(v);
        if (!parsed) {
          setStatus(
            "Unrecognized color. Try hex, rgb(a), hsl(a), or a CSS color name.",
            false
          );
          return;
        }
        setStatus("");
        current = { r: parsed.r, g: parsed.g, b: parsed.b, a: parsed.a };
        detectedEl.textContent = (parsed.type || "").toUpperCase();
        updateAll(true);
      }

      inputEl.addEventListener("input", handleInputChange);
      displayTypeEl.addEventListener("change", () => updateAll(false));

      // simple picker removed

      // alpha input removed (use HSLA CSS output or adjust via UI picker)

      function onHslChange() {}

      // numeric HSL inputs removed

      // Improve spinner up/down behavior: normalize on blur
      // normalization for removed inputs not needed

      copyButtons.forEach((btn) => {
        btn.addEventListener("click", async () => {
          let text = "";
          switch (btn.dataset.copy) {
            case "hex":
              text = outHex.textContent;
              break;
            case "rgb":
              text = outRgb.textContent;
              break;
            case "rgba":
              text = outRgba.textContent;
              break;
            case "hsl":
              text = outHsl.textContent;
              break;
            case "hsla":
              text = outHsla.textContent;
              break;
            case "csshsl":
              text = outCssHsl.textContent;
              break;
            case "csshsla":
              text = outCssHsla.textContent;
              break;
          }
          try {
            await navigator.clipboard.writeText(text);
            setStatus(
              "Copied " + btn.dataset.copy.toUpperCase() + " to clipboard",
              true
            );
          } catch {
            setStatus("Copy failed. Select and copy manually.", false);
          }
        });
      });

      // Row click copies
      copyRows.forEach((row) => {
        row.addEventListener("click", (e) => {
          if (
            e.target instanceof HTMLElement &&
            e.target.classList.contains("copyBtn")
          )
            return;
          const btn = row.querySelector(".copyBtn");
          if (btn) btn.dispatchEvent(new Event("click"));
        });
      });

      // Drag picker utilities
      function setHueBackground() {
        hueBar.style.background =
          "linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red)";
      }
      function setSLBackground() {
        const { h } = rgbToHsl(current);
        slPanel.style.background = `hsl(${Math.round(h)}, 100%, 50%)`;
      }
      function positionHandles() {
        const { h, s, l } = rgbToHsl(current);
        const rectSl = slPanel.getBoundingClientRect();
        slHandle.style.left = `${s * rectSl.width}px`;
        slHandle.style.top = `${(1 - l) * rectSl.height}px`;
        const rectHue = hueBar.getBoundingClientRect();
        hueHandle.style.left = `${(h / 360) * rectHue.width}px`;
      }
      function handleSLPointer(clientX, clientY) {
        const r = slPanel.getBoundingClientRect();
        const x = clamp(clientX - r.left, 0, r.width);
        const y = clamp(clientY - r.top, 0, r.height);
        const s = clamp(x / r.width, 0, 1);
        const l = clamp(1 - y / r.height, 0, 1);
        const { h } = rgbToHsl(current);
        const rgb = hslToRgb({ h, s, l });
        current = { ...current, ...rgb };
        updateAll(false, "HSL");
        positionHandles();
      }
      function handleHuePointer(clientX) {
        const r = hueBar.getBoundingClientRect();
        const x = clamp(clientX - r.left, 0, r.width);
        const h = clamp((x / r.width) * 360, 0, 360);
        const { s, l } = rgbToHsl(current);
        const rgb = hslToRgb({ h, s, l });
        current = { ...current, ...rgb };
        updateAll(false, "HUE");
        setSLBackground();
        positionHandles();
      }
      function bindDrag(el, onMove) {
        let down = false;
        const move = (e) => {
          if (!down) return;
          onMove(e.clientX, e.clientY);
          e.preventDefault();
        };
        el.addEventListener("pointerdown", (e) => {
          down = true;
          el.setPointerCapture(e.pointerId);
          onMove(e.clientX, e.clientY);
        });
        el.addEventListener("pointermove", move);
        document.addEventListener("pointerup", () => {
          down = false;
        });
      }
      bindDrag(slPanel, handleSLPointer);
      bindDrag(hueBar, (x) => handleHuePointer(x));

      // Initialize
      inputEl.value = "#4cc9f0";
      handleInputChange();
      setHueBackground();
      setSLBackground();
      positionHandles();
    </script>
  </body>
</html>
